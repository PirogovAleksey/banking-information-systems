<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тема 2: Message Queues та Event-Driven Architecture</title>
    <link rel="stylesheet" href="../../../../assets/css/slides.css">
</head>
<body class="slides-page">
<div class="slides-wrapper">
    <!-- Navigation -->
    <div class="slide-navigation">
        <button class="slide-btn" onclick="previousSlide()">◀</button>
        <span class="slide-counter" id="slideCounter">1 / 12</span>
        <button class="slide-btn" onclick="nextSlide()">▶</button>
        <button class="slide-btn" onclick="toggleFullscreen()">⛶</button>
        <button class="slide-btn" onclick="exitPresentation()">✕</button>
    </div>

    <!-- Progress Bar -->
    <div class="slide-progress">
        <div class="slide-progress-bar" id="progressBar" style="width: 8.33%;"></div>
    </div>

    <!-- Slide 1: Title -->
    <div class="slide active" id="slide1">
        <div class="slide-container">
            <div class="slide-title">
                <h1>Message Queues та Event-Driven Architecture</h1>
                <div class="subtitle">Async Communication in Banking Systems</div>
                <div class="content">
                    <p><strong>Модуль 2:</strong> Core Banking Systems</p>
                    <p><strong>Лекція 2.2:</strong> Інтеграція CBS з зовнішніми системами</p>
                    <p><strong>Тема 2</strong></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 2: Apache Kafka Architecture -->
    <div class="slide" id="slide2">
        <div class="slide-container">
            <div class="slide-content">
                <h2>Apache Kafka для банківських систем</h2>
                <h3>Distributed Event Streaming Platform</h3>
                <div style="margin: 20px 0;">
                    <h4>Ключові компоненти:</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div style="background: rgba(100,255,218,0.2); padding: 15px; border-radius: 8px;">
                            <h4>Producers</h4>
                            <ul class="slide-list">
                                <li>Публікують події в topics</li>
                                <li>Partitioning по ключу</li>
                                <li>Асинхронна або синхронна відправка</li>
                                <li>Compression (gzip, snappy, lz4)</li>
                            </ul>
                        </div>
                        <div style="background: rgba(255,100,100,0.2); padding: 15px; border-radius: 8px;">
                            <h4>Brokers</h4>
                            <ul class="slide-list">
                                <li>Зберігають події в log</li>
                                <li>Replication factor (3-5)</li>
                                <li>Partition leader election</li>
                                <li>Retention policy (days/size)</li>
                            </ul>
                        </div>
                        <div style="background: rgba(255,255,100,0.2); padding: 15px; border-radius: 8px;">
                            <h4>Consumers</h4>
                            <ul class="slide-list">
                                <li>Consumer groups</li>
                                <li>Offset management</li>
                                <li>At-least-once delivery</li>
                                <li>Rebalancing</li>
                            </ul>
                        </div>
                        <div style="background: rgba(255,100,255,0.2); padding: 15px; border-radius: 8px;">
                            <h4>Zookeeper / KRaft</h4>
                            <ul class="slide-list">
                                <li>Cluster coordination</li>
                                <li>Leader election</li>
                                <li>Config management</li>
                                <li>KRaft = ZooKeeper replacement</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="alert alert-info">
                    <strong>Performance:</strong> Kafka може обробляти 1M+ messages/sec на commodity hardware
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 3: Kafka Use Cases in Banking -->
    <div class="slide" id="slide3">
        <div class="slide-container">
            <div class="slide-content">
                <h2>Kafka Use Cases у банках</h2>
                <h3>Типові сценарії використання</h3>
                <div style="margin: 20px 0;">
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4>1. Transaction Processing</h4>
                        <p><strong>Приклад:</strong> Обробка card transactions</p>
                        <ul class="slide-list">
                            <li>POS terminal → Kafka → Authorization service → Fraud detection → Settlement</li>
                            <li>Topics: card-transactions, fraud-alerts, settlement-requests</li>
                            <li>Latency: &lt;50ms для authorization</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4>2. Real-time Fraud Detection</h4>
                        <p><strong>Приклад:</strong> Виявлення підозрілих транзакцій</p>
                        <ul class="slide-list">
                            <li>Kafka Streams для real-time processing</li>
                            <li>ML models споживають транзакції в реальному часі</li>
                            <li>Score &gt; threshold → alert → block transaction</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4>3. Event Sourcing для Audit Trail</h4>
                        <p><strong>Приклад:</strong> Immutable history всіх змін</p>
                        <ul class="slide-list">
                            <li>Всі операції як події: AccountCreated, MoneyTransferred, etc.</li>
                            <li>Infinite retention для compliance</li>
                            <li>Replay можливість для debugging</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4>4. Data Synchronization</h4>
                        <p><strong>Приклад:</strong> CDC (Change Data Capture)</p>
                        <ul class="slide-list">
                            <li>Debezium connector читає PostgreSQL WAL</li>
                            <li>Реплікація в analytical warehouse (Snowflake)</li>
                            <li>Near real-time BI dashboards</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 4: RabbitMQ vs Kafka -->
    <div class="slide" id="slide4">
        <div class="slide-container">
            <div class="slide-content">
                <h2>RabbitMQ vs Apache Kafka</h2>
                <h3>Порівняння двох лідерів messaging</h3>
                <table style="width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 0.85em;">
                    <tr style="background: var(--color-primary); color: white;">
                        <th style="padding: 10px; border: 1px solid #ddd;">Критерій</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">RabbitMQ</th>
                        <th style="padding: 10px; border: 1px solid #ddd;">Apache Kafka</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Модель</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Message Broker (Push)</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Event Log (Pull)</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Throughput</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">20K-50K msg/sec</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">1M+ msg/sec</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Latency</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Microseconds</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Milliseconds</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Retention</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Видаляється після consume</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Configurable (days/forever)</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Routing</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Flexible (exchanges, bindings)</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Simple (topics, partitions)</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Protocol</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">AMQP, MQTT, STOMP</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Custom binary protocol</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Message ordering</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Per queue</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Per partition</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px; border: 1px solid #ddd;"><strong>Use case</strong></td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Task queues, RPC</td>
                        <td style="padding: 10px; border: 1px solid #ddd;">Event streaming, logs</td>
                    </tr>
                </table>
                <div class="alert alert-success">
                    <strong>Вибір:</strong> RabbitMQ для task queues + низької latency, Kafka для high-throughput + event sourcing
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 5: Event-Driven Patterns -->
    <div class="slide" id="slide5">
        <div class="slide-container">
            <div class="slide-content">
                <h2>Event-Driven Architecture Patterns</h2>
                <h3>Ключові патерни для банківських систем</h3>
                <div style="margin: 20px 0;">
                    <div style="background: rgba(100,255,218,0.2); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4>1. Event Sourcing</h4>
                        <p><strong>Суть:</strong> Зберігаємо історію змін, а не поточний стан</p>
                        <ul class="slide-list">
                            <li>Всі зміни = immutable events</li>
                            <li>Поточний стан = projection від подій</li>
                            <li>Повна історія для audit та debugging</li>
                            <li><strong>Приклад:</strong> Account balance = sum(all deposit/withdrawal events)</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,100,100,0.2); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4>2. CQRS (Command Query Responsibility Segregation)</h4>
                        <p><strong>Суть:</strong> Розділення read і write моделей</p>
                        <ul class="slide-list">
                            <li>Command side: обробка транзакцій (write)</li>
                            <li>Query side: оптимізовані read models</li>
                            <li>Eventual consistency через events</li>
                            <li><strong>Приклад:</strong> Transaction processing (PostgreSQL) → Events → Analytics (ClickHouse)</li>
                        </ul>
                    </div>
                    <div style="background: rgba(255,255,100,0.2); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4>3. Saga Pattern</h4>
                        <p><strong>Суть:</strong> Distributed transactions через compensating actions</p>
                        <ul class="slide-list">
                            <li>Choreography: сервіси реагують на події</li>
                            <li>Orchestration: центральний координатор</li>
                            <li>Compensating transactions для rollback</li>
                            <li><strong>Приклад:</strong> Money transfer = DebitAccount + CreditAccount + SendNotification (з rollback логікою)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 6: CQRS Implementation Example -->
    <div class="slide" id="slide6">
        <div class="slide-container">
            <div class="slide-content">
                <h2>CQRS Implementation в банку</h2>
                <h3>Приклад: Transaction Processing + Analytics</h3>
                <div style="margin: 20px 0;">
                    <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 8px;">
                        <h4>Architecture Flow:</h4>
                        <div style="margin: 15px 0; padding: 15px; background: rgba(100,255,218,0.2); border-left: 4px solid #4ade80; border-radius: 4px;">
                            <p><strong>COMMAND SIDE (Write):</strong></p>
                            <p>Client → REST API → Command Handler → PostgreSQL (normalized) → Kafka Event</p>
                        </div>
                        <div style="margin: 15px 0; padding: 15px; background: rgba(255,100,255,0.2); border-left: 4px solid #a855f7; border-radius: 4px;">
                            <p><strong>EVENT STREAM:</strong></p>
                            <p>Kafka Topics: transactions, account-updates, fraud-alerts</p>
                        </div>
                        <div style="margin: 15px 0; padding: 15px; background: rgba(255,255,100,0.2); border-left: 4px solid #f59e0b; border-radius: 4px;">
                            <p><strong>QUERY SIDE (Read):</strong></p>
                            <p>Kafka Consumer → Materialized Views → ClickHouse/Elasticsearch → Analytics API</p>
                        </div>
                    </div>
                    <h4 style="margin-top: 20px;">Переваги:</h4>
                    <ul class="slide-list">
                        <li><strong>Масштабованість:</strong> Read і write scale незалежно</li>
                        <li><strong>Performance:</strong> Оптимізовані read models (denormalized)</li>
                        <li><strong>Flexibility:</strong> Додавання нових projections без впливу на write side</li>
                        <li><strong>Resilience:</strong> Збій analytics не впливає на transactions</li>
                    </ul>
                </div>
                <div class="alert alert-warning">
                    <strong>Trade-off:</strong> Eventual consistency - read models можуть відставати на 100-500ms
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 7: Saga Pattern Example -->
    <div class="slide" id="slide7">
        <div class="slide-container">
            <div class="slide-content">
                <h2>Saga Pattern: Money Transfer</h2>
                <h3>Distributed transaction з compensating actions</h3>
                <div style="margin: 20px 0;">
                    <h4>Choreography-based Saga:</h4>
                    <div style="margin: 15px 0;">
                        <div style="background: rgba(74,222,128,0.2); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                            <strong>Step 1:</strong> Transfer initiated → <code>TransferInitiated</code> event
                        </div>
                        <div style="background: rgba(74,222,128,0.2); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                            <strong>Step 2:</strong> Account Service слухає → дебетує відправника → <code>AccountDebited</code>
                        </div>
                        <div style="background: rgba(74,222,128,0.2); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                            <strong>Step 3:</strong> Account Service → кредитує отримувача → <code>AccountCredited</code>
                        </div>
                        <div style="background: rgba(74,222,128,0.2); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                            <strong>Step 4:</strong> Notification Service → відправляє SMS/Push → <code>NotificationSent</code>
                        </div>
                        <div style="background: rgba(74,222,128,0.2); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                            <strong>Step 5:</strong> <code>TransferCompleted</code> event
                        </div>
                    </div>
                    <h4 style="margin-top: 20px; color: #ef4444;">Compensating Actions (Rollback):</h4>
                    <div style="margin: 15px 0;">
                        <div style="background: rgba(239,68,68,0.2); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                            <strong>Якщо Step 3 fails:</strong> Credit failed → публікуємо <code>TransferFailed</code>
                        </div>
                        <div style="background: rgba(239,68,68,0.2); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                            <strong>Compensate:</strong> Account Service слухає → refund дебет → <code>AccountRefunded</code>
                        </div>
                        <div style="background: rgba(239,68,68,0.2); padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                            <strong>Notify:</strong> Notification Service → повідомлення про failure
                        </div>
                    </div>
                </div>
                <div class="alert alert-info">
                    <strong>Key:</strong> Кожен сервіс відповідальний за свої compensating actions. Немає 2PC overhead.
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 8: Async Transaction Processing -->
    <div class="slide" id="slide8">
        <div class="slide-container">
            <div class="slide-content">
                <h2>Асинхронна обробка транзакцій</h2>
                <h3>Patterns для high-throughput banking</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <h4>Synchronous (Traditional):</h4>
                        <div style="background: rgba(239,68,68,0.2); padding: 15px; border-radius: 8px;">
                            <p>Client → API → Process → DB → Response</p>
                            <ul style="font-size: 0.9em; margin-top: 10px;">
                                <li><strong>Pros:</strong> Immediate feedback</li>
                                <li><strong>Cons:</strong> Client чекає, low throughput, coupling</li>
                                <li><strong>Latency:</strong> 200-500ms</li>
                                <li><strong>Max throughput:</strong> ~5K TPS</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h4>Asynchronous (Event-Driven):</h4>
                        <div style="background: rgba(74,222,128,0.2); padding: 15px; border-radius: 8px;">
                            <p>Client → API → Kafka → Worker → DB</p>
                            <ul style="font-size: 0.9em; margin-top: 10px;">
                                <li><strong>Pros:</strong> High throughput, decoupling, resilience</li>
                                <li><strong>Cons:</strong> Eventual consistency, складність</li>
                                <li><strong>Latency:</strong> 50-100ms (API response)</li>
                                <li><strong>Max throughput:</strong> 100K+ TPS</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <h4 style="margin-top: 20px;">Hybrid Approach:</h4>
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                    <ul class="slide-list">
                        <li><strong>Критичні операції:</strong> Synchronous (e.g., card authorization - must be &lt;50ms)</li>
                        <li><strong>Batch операції:</strong> Asynchronous (e.g., statement generation, reporting)</li>
                        <li><strong>Notifications:</strong> Asynchronous (e.g., SMS, email, push)</li>
                        <li><strong>Analytics:</strong> Asynchronous (e.g., fraud detection, recommendations)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 9: Real-World Banking Example -->
    <div class="slide" id="slide9">
        <div class="slide-container">
            <div class="slide-banking-example">
                <div class="banking-logo">🏦</div>
                <div class="banking-title">Кейс: Goldman Sachs - Kafka Migration</div>
                <h3>Від Legacy ESB до Event-Driven Architecture</h3>
                <div style="margin: 20px 0;">
                    <h4>Проблема (Before):</h4>
                    <ul class="slide-list">
                        <li>Legacy ESB (Enterprise Service Bus) не справлявся з навантаженням</li>
                        <li>Throughput: 10K transactions/sec (peak demand: 100K+)</li>
                        <li>Monolithic coupling між сервісами</li>
                        <li>Downtime ESB = downtime всіх сервісів</li>
                    </ul>
                    <h4 style="margin-top: 20px;">Рішення (After):</h4>
                    <ul class="slide-list">
                        <li>Міграція на Apache Kafka (2019-2021)</li>
                        <li>300+ Kafka topics для різних event types</li>
                        <li>Kafka Connect для CDC (Change Data Capture)</li>
                        <li>Kafka Streams для real-time processing</li>
                    </ul>
                    <h4 style="margin-top: 20px;">Результати:</h4>
                    <div class="slide-statistics">
                        <div class="stat-item">
                            <div class="stat-value">10x</div>
                            <div class="stat-description">Throughput збільшено</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">99.99%</div>
                            <div class="stat-description">Availability</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">-60%</div>
                            <div class="stat-description">Latency зменшено</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">40%</div>
                            <div class="stat-description">Cost savings</div>
                        </div>
                    </div>
                </div>
                <div class="alert alert-success">
                    <strong>Висновок:</strong> Event-driven architecture критична для high-frequency trading та real-time banking
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 10: Delivery Guarantees -->
    <div class="slide" id="slide10">
        <div class="slide-container">
            <div class="slide-content">
                <h2>Message Delivery Guarantees</h2>
                <h3>At-most-once vs At-least-once vs Exactly-once</h3>
                <div style="margin: 20px 0;">
                    <div style="background: rgba(239,68,68,0.2); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4>At-most-once (Fire and Forget)</h4>
                        <p><strong>Гарантія:</strong> Message може бути втрачено, але ніколи не дублюється</p>
                        <ul class="slide-list">
                            <li>Producer не чекає acknowledgment</li>
                            <li>Найшвидше, але ненадійне</li>
                            <li><strong>Use case:</strong> Metrics, logs (non-critical data)</li>
                        </ul>
                    </div>
                    <div style="background: rgba(251,191,36,0.2); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4>At-least-once (Default у Kafka)</h4>
                        <p><strong>Гарантія:</strong> Message точно доставлено, але може дублюватись</p>
                        <ul class="slide-list">
                            <li>Producer чекає ack, retry у випадку failure</li>
                            <li>Consumer повинен бути idempotent</li>
                            <li><strong>Use case:</strong> Більшість banking operations з idempotency keys</li>
                        </ul>
                    </div>
                    <div style="background: rgba(74,222,128,0.2); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <h4>Exactly-once (Kafka Transactions)</h4>
                        <p><strong>Гарантія:</strong> Message доставлено рівно один раз</p>
                        <ul class="slide-list">
                            <li>Kafka transactions (enable.idempotence=true)</li>
                            <li>Найповільніше через координацію</li>
                            <li><strong>Use case:</strong> Financial transactions, payment processing</li>
                        </ul>
                    </div>
                </div>
                <div class="alert alert-warning">
                    <strong>Banking reality:</strong> At-least-once + idempotency keys = практичний exactly-once
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 11: Reliability Patterns -->
    <div class="slide" id="slide11">
        <div class="slide-container">
            <div class="slide-cyber-security">
                <h2>Reliability та Resilience Patterns</h2>
                <h3>Забезпечення надійності messaging систем</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <h4>Retry Strategies:</h4>
                        <ul class="slide-list">
                            <li><strong>Exponential backoff:</strong> 1s, 2s, 4s, 8s...</li>
                            <li><strong>Max retry attempts:</strong> 3-5 спроб</li>
                            <li><strong>Dead Letter Queue:</strong> failed messages окремо</li>
                            <li><strong>Circuit breaker:</strong> stop retry якщо downstream down</li>
                        </ul>
                    </div>
                    <div>
                        <h4>Monitoring & Alerting:</h4>
                        <ul class="slide-list">
                            <li><strong>Consumer lag:</strong> alert якщо &gt; 1000 messages</li>
                            <li><strong>Error rate:</strong> alert якщо &gt; 1%</li>
                            <li><strong>Throughput:</strong> anomaly detection</li>
                            <li><strong>Partition rebalancing:</strong> track frequency</li>
                        </ul>
                    </div>
                </div>
                <h4 style="margin-top: 20px;">High Availability Setup:</h4>
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin: 20px 0;">
                    <ul class="slide-list">
                        <li><strong>Kafka cluster:</strong> 3-5 brokers мінімум</li>
                        <li><strong>Replication factor:</strong> 3 (tolerates 2 broker failures)</li>
                        <li><strong>Min in-sync replicas:</strong> 2 (гарантує durability)</li>
                        <li><strong>Rack awareness:</strong> розподіл brokers по AZ</li>
                        <li><strong>Multi-region replication:</strong> для disaster recovery</li>
                    </ul>
                </div>
                <div class="cyber-threat-level threat-low">✅ Правильна конфігурація = 99.99% availability</div>
            </div>
        </div>
    </div>

    <!-- Slide 12: Підсумки -->
    <div class="slide" id="slide12">
        <div class="slide-container">
            <div class="slide-content">
                <h2>Підсумки: Message Queues та EDA</h2>
                <h3>Ключові висновки</h3>
                <ul class="slide-list">
                    <li><strong>Kafka vs RabbitMQ:</strong> Kafka для high-throughput + event sourcing, RabbitMQ для task queues</li>
                    <li><strong>Apache Kafka архітектура:</strong> Producers, Brokers, Consumers, Topics/Partitions</li>
                    <li><strong>Event-Driven patterns:</strong> Event Sourcing, CQRS, Saga для distributed transactions</li>
                    <li><strong>CQRS переваги:</strong> Незалежне масштабування read/write, оптимізовані projections</li>
                    <li><strong>Saga pattern:</strong> Choreography або Orchestration для розподілених транзакцій</li>
                    <li><strong>Async processing:</strong> 10-20x вище throughput порівняно з synchronous</li>
                    <li><strong>Goldman Sachs приклад:</strong> 10x throughput покращення після міграції на Kafka</li>
                    <li><strong>Delivery guarantees:</strong> At-least-once + idempotency = практичний exactly-once</li>
                    <li><strong>Reliability критична:</strong> Replication factor 3+, min ISR 2, monitoring обов'язковий</li>
                </ul>
                <div class="alert alert-success">
                    <h4>Наступна тема:</h4>
                    <p>API Security: OAuth 2.0, JWT та OWASP API Security Top 10</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let currentSlide = 1;
    const totalSlides = 12;

    function showSlide(n) {
        const slides = document.querySelectorAll('.slide');
        const progressBar = document.getElementById('progressBar');
        const counter = document.getElementById('slideCounter');

        if (n > totalSlides) currentSlide = 1;
        if (n < 1) currentSlide = totalSlides;

        slides.forEach(slide => slide.classList.remove('active'));
        document.getElementById(`slide${currentSlide}`).classList.add('active');

        progressBar.style.width = (currentSlide / totalSlides * 100) + '%';
        counter.textContent = `${currentSlide} / ${totalSlides}`;
    }

    function nextSlide() {
        currentSlide++;
        showSlide(currentSlide);
    }

    function previousSlide() {
        currentSlide--;
        showSlide(currentSlide);
    }

    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            document.exitFullscreen();
        }
    }

    function exitPresentation() {
        window.location.href = 'index.html';
    }

    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        switch(e.key) {
            case 'ArrowRight':
            case ' ':
                nextSlide();
                break;
            case 'ArrowLeft':
                previousSlide();
                break;
            case 'Escape':
                exitPresentation();
                break;
            case 'f':
            case 'F':
                toggleFullscreen();
                break;
            case 'Home':
                currentSlide = 1;
                showSlide(currentSlide);
                break;
            case 'End':
                currentSlide = totalSlides;
                showSlide(currentSlide);
                break;
        }
    });

    // Touch events for mobile
    let startX = null;
    document.addEventListener('touchstart', function(e) {
        startX = e.touches[0].clientX;
    });

    document.addEventListener('touchend', function(e) {
        if (!startX) return;

        const endX = e.changedTouches[0].clientX;
        const diffX = startX - endX;

        if (Math.abs(diffX) > 50) {
            if (diffX > 0) {
                nextSlide();
            } else {
                previousSlide();
            }
        }
        startX = null;
    });

    // Initialize
    showSlide(1);

    // Save progress
    function saveProgress() {
        try {
            const progress = {
                currentSlide: currentSlide,
                totalSlides: totalSlides,
                timestamp: new Date().toISOString(),
                topic: 'Message Queues and Event-Driven Architecture'
            };
            localStorage.setItem('lecture_2_2_tema2_progress', JSON.stringify(progress));
        } catch(e) {
            console.log('Could not save progress');
        }
    }

    // Load progress
    function loadProgress() {
        try {
            const saved = localStorage.getItem('lecture_2_2_tema2_progress');
            if (saved) {
                const progress = JSON.parse(saved);
                if (progress.currentSlide) {
                    currentSlide = progress.currentSlide;
                    showSlide(currentSlide);
                }
            }
        } catch(e) {
            console.log('Could not load progress');
        }
    }

    window.addEventListener('beforeunload', saveProgress);
    loadProgress();
</script>
</body>
</html>
